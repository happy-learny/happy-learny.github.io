"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[471],{1471:(e,o,n)=>{n.r(o),n.d(o,{default:()=>D});var l=n(3673),t=n(2323);const a={class:"text-h6"},s=(0,l.Uk)(" К урокам "),i={key:0},c=(0,l.Uk)(" Выйти "),u=(0,l._)("div",{class:"text-h6"}," войти через ",-1),d=(0,l.Uk)(" гугл "),r=(0,l.Uk)(" Что сделать с материалом, созданным в гостевом аккаунте? "),g={class:"q-gutter-lg q-pa-lg"};function p(e,o,n,p,h,m){const v=(0,l.up)("q-btn"),f=(0,l.up)("q-page"),w=(0,l.up)("q-card-section"),S=(0,l.up)("q-card"),_=(0,l.up)("q-dialog"),k=(0,l.Q2)("close-popup");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l.Wm)(f,{class:"column items-center q-pa-lg q-col-gutter-lg"},{default:(0,l.w5)((()=>[(0,l._)("div",a," Привет, "+(0,t.zw)(e.user.name),1),(0,l._)("div",null,[(0,l.Wm)(v,{to:e.lessonsRoute},{default:(0,l.w5)((()=>[s])),_:1},8,["to"])]),e.user.socialId?((0,l.wg)(),(0,l.iD)("div",i,[(0,l.Wm)(v,{loading:e.isLoading,onClick:e.logout},{default:(0,l.w5)((()=>[c])),_:1},8,["loading","onClick"])])):((0,l.wg)(),(0,l.iD)(l.HY,{key:1},[u,(0,l._)("div",null,[(0,l.Wm)(v,{loading:e.isLoading,onClick:e.login},{default:(0,l.w5)((()=>[d])),_:1},8,["loading","onClick"])])],64))])),_:1}),(0,l.Wm)(_,{modelValue:e.showHasLessonsModal,"onUpdate:modelValue":o[2]||(o[2]=o=>e.showHasLessonsModal=o)},{default:(0,l.w5)((()=>[(0,l.Wm)(S,{class:"column"},{default:(0,l.w5)((()=>[(0,l.Wm)(w,{class:"text-h6 q-pa-lg"},{default:(0,l.w5)((()=>[r])),_:1}),(0,l._)("div",g,[(0,l.wy)((0,l.Wm)(v,{label:"Отмена"},null,512),[[k]]),(0,l.wy)((0,l.Wm)(v,{label:"Перенести",color:"secondary",onClick:o[0]||(o[0]=o=>e.changeAction("replace"))},null,512),[[k]]),(0,l.wy)((0,l.Wm)(v,{label:"Удалить",color:"red",onClick:o[1]||(o[1]=o=>e.changeAction("delete"))},null,512),[[k]])])])),_:1})])),_:1},8,["modelValue"])],64)}var h=n(1959),m=n(3863),v=n(829),f=n(238),w=n(9253),S=n(9582),_=n(9232),k=n(6912),y=n(2801),C=n(1768),E=n(8825),L=function(e,o,n,l){function t(e){return e instanceof n?e:new n((function(o){o(e)}))}return new(n||(n=Promise))((function(n,a){function s(e){try{c(l.next(e))}catch(o){a(o)}}function i(e){try{c(l["throw"](e))}catch(o){a(o)}}function c(e){e.done?n(e.value):t(e.value).then(s,i)}c((l=l.apply(e,o||[])).next())}))};const Z=(0,l.aZ)({name:"PageIndex",setup(){const e=(0,m.useStore)(),o=(0,S.tv)(),n=(0,E.Z)();e.dispatch(v.D.FETCH_USER);const l=(0,h.Fl)((()=>e.state.user)),t=(0,h.iH)(!1),a=(0,h.iH)(!1),{lessons:s}=e.state.lesson,i=()=>{if(n.platform.is.cordova){const o=cordova.InAppBrowser.open(`${C.baseURL}/auth/google`,"_blank","location=yes");o.addEventListener("loadstart",(n=>L(this,void 0,void 0,(function*(){if("https://happy-learny.github.io/#/login/social"===n.url){o.close();const n=yield y.Z.auth.loginSocial();e.commit(f.F.SET_ACCESS_TOKEN,n.accessToken),window.location.reload()}}))))}else window.location.replace(`${C.baseURL}/auth/google`)},c=e=>L(this,void 0,void 0,(function*(){t.value=!0,yield y.Z.user.changeAction(e).catch((()=>{t.value=!1})),i()})),u=()=>L(this,void 0,void 0,(function*(){t.value=!0,yield e.dispatch(v.D.LOGOUT_USER).finally((()=>{t.value=!1})),yield o.push({name:w.n.LOGIN}),e.commit(f.F.SET_ACCESS_TOKEN,""),e.commit(_.N.SET_LESSONS,[])})),d=()=>L(this,void 0,void 0,(function*(){s.length||(yield e.dispatch(k.e.FETCH_LESSONS),e.state.lesson.lessons.length)?a.value=!0:i()})),r={name:w.n.LESSONS};return{user:l,logout:u,login:d,isLoading:t,lessonsRoute:r,showHasLessonsModal:a,changeAction:c}}});var b=n(4260),q=n(4379),U=n(2452),W=n(6818),H=n(151),T=n(5589),O=n(677),A=n(7518),N=n.n(A);const x=(0,b.Z)(Z,[["render",p]]),D=x;N()(Z,"components",{QPage:q.Z,QBtn:U.Z,QDialog:W.Z,QCard:H.Z,QCardSection:T.Z}),N()(Z,"directives",{ClosePopup:O.Z})}}]);